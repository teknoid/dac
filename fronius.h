#define CHUNK_SIZE 		2048

#define	HEATERS			"plug9"
#define HEATER_WATT		600

#define BOILERS			"boiler1", "boiler2", "boiler3"
#define BOILER_WATT		2000
#define BOILER_STANDBY	20
#define BOILER_PERCENT	BOILER_WATT / 100

// Fronius API is slow --> timings <5s make no sense
#define WAIT_OFFLINE	900
#define WAIT_STANDBY	300
#define WAIT_KEEP		60
#define WAIT_RAMPUP		5
#define WAIT_RAMPDOWN	5

#define STANDBY_EXPIRE	3600 / WAIT_STANDBY

#define PV_HISTORY		16

#define PHASE_ANGLES_BOILER1 \
0, 2370, 2380, 2400, 2425, 2450, 2475, 2500, 2533, 2566, 2600,\
2640, 2680, 2720, 2760, 2800, 2840, 2880, 2920, 2960, 3000,\
3040, 3080, 3120, 3160, 3200, 3240, 3280, 3320, 3360, 3400,\
3445, 3490, 3535, 3580, 3625, 3670, 3715, 3760, 3805, 3850,\
3900, 3950, 4000, 4050, 4100, 4150, 4200, 4250, 4300, 4350,\
4405, 4460, 4515, 4570, 4625, 4680, 4735, 4790, 4845, 4900,\
4960, 5020, 5080, 5140, 5200, 5260, 5320, 5380, 5440, 5500,\
5565, 5630, 5695, 5760, 5825, 5890, 5955, 6020, 6085, 6150,\
6220, 6290, 6360, 6430, 6500, 6570, 6640, 6710, 6780, 6860,\
6950, 7050, 7150, 7350, 7550, 7800, 8100, 8400, 8800, 10000

#define PHASE_ANGLES_BOILER2_600 \
0, 2395, 2524, 2693, 2845, 2980, 3098, 3199, 3283, 3350, 3400,\
3440, 3480, 3520, 3560, 3600, 3640, 3680, 3720, 3760, 3800,\
3835, 3870, 3905, 3940, 3975, 4010, 4045, 4080, 4115, 4150,\
4185, 4220, 4255, 4290, 4325, 4360, 4395, 4430, 4465, 4500,\
4540, 4580, 4620, 4660, 4700, 4740, 4780, 4820, 4860, 4900,\
4945, 4990, 5035, 5080, 5125, 5170, 5215, 5260, 5305, 5350,\
5400, 5450, 5500, 5550, 5600, 5650, 5700, 5750, 5800, 5850,\
5915, 5980, 6045, 6110, 6175, 6240, 6305, 6370, 6435, 6500,\
6580, 6660, 6740, 6820, 6900, 6980, 7060, 7140, 7220, 7300,\
7380, 7450, 7600, 7750, 7900, 8000, 8250, 8500, 8800, 10000

#define PHASE_ANGLES_BOILER2_2000 \
0, 2750, 2875, 2975, 3075, 3150, 3225, 3300, 3350, 3400, 3450,\
3500, 3550, 3600, 3650, 3700, 3750, 3800, 3850, 3900, 3950,\
3980, 4010, 4040, 4070, 4100, 4130, 4160, 4190, 4220, 4250,\
4290, 4330, 4370, 4410, 4450, 4490, 4530, 4570, 4610, 4650,\
4690, 4730, 4770, 4810, 4850, 4890, 4930, 4970, 5010, 5050,\
5095, 5140, 5185, 5230, 5275, 5320, 5365, 5410, 5455, 5500,\
5550, 5600, 5650, 5700, 5750, 5800, 5850, 5900, 5950, 6000,\
6050, 6100, 6150, 6200, 6250, 6300, 6350, 6400, 6450, 6500,\
6580, 6660, 6740, 6820, 6900, 6980, 7060, 7140, 7220, 7300,\
7380, 7450, 7600, 7750, 7900, 8000, 8250, 8500, 8800, 10000

//#define URL			"http://fronius/solar_api/v1/GetMeterRealtimeData.cgi?Scope=Device&DeviceId=0"
#define URL				"http://fronius/solar_api/v1/GetPowerFlowRealtimeData.fcgi"

typedef struct get_response_t {
	char *buffer;
	size_t len;
	size_t buflen;
} get_response_t;

typedef struct device_t {
	const char *name;
	const char *addr;
	int active;
	int override;
	int power;
} device_t;

void fronius_override(int index);
